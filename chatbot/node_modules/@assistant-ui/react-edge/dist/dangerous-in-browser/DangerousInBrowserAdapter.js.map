{"version":3,"sources":["../../src/dangerous-in-browser/DangerousInBrowserAdapter.ts"],"sourcesContent":["import { toCoreMessages } from \"../converters/toCoreMessages\";\nimport { toLanguageModelTools } from \"../converters/toLanguageModelTools\";\nimport { EdgeRuntimeRequestOptions } from \"../edge/EdgeRuntimeRequestOptions\";\nimport { asAsyncIterableStream } from \"assistant-stream/utils\";\nimport {\n  CreateEdgeRuntimeAPIOptions,\n  getEdgeRuntimeStream,\n} from \"../edge/createEdgeRuntimeAPI\";\nimport {\n  AssistantMessageAccumulator,\n  unstable_toolResultStream,\n} from \"assistant-stream\";\nimport { ChatModelAdapter, ChatModelRunOptions } from \"@assistant-ui/react\";\n\nexport type DangerousInBrowserAdapterOptions = CreateEdgeRuntimeAPIOptions;\n\nexport class DangerousInBrowserAdapter implements ChatModelAdapter {\n  constructor(private options: DangerousInBrowserAdapterOptions) {}\n\n  async *run({ messages, abortSignal, context }: ChatModelRunOptions) {\n    const res = await getEdgeRuntimeStream({\n      options: this.options,\n      abortSignal,\n      requestData: {\n        system: context.system,\n        messages: toCoreMessages(messages),\n        tools: context.tools ? toLanguageModelTools(context.tools) : [],\n        ...context.callSettings,\n        ...context.config,\n      } satisfies EdgeRuntimeRequestOptions,\n    });\n\n    const stream = res\n      .pipeThrough(unstable_toolResultStream(context.tools, abortSignal))\n      .pipeThrough(new AssistantMessageAccumulator());\n\n    yield* asAsyncIterableStream(stream);\n  }\n}\n"],"mappings":";AAAA,SAAS,sBAAsB;AAC/B,SAAS,4BAA4B;AAErC,SAAS,6BAA6B;AACtC;AAAA,EAEE;AAAA,OACK;AACP;AAAA,EACE;AAAA,EACA;AAAA,OACK;AAKA,IAAM,4BAAN,MAA4D;AAAA,EACjE,YAAoB,SAA2C;AAA3C;AAAA,EAA4C;AAAA,EAEhE,OAAO,IAAI,EAAE,UAAU,aAAa,QAAQ,GAAwB;AAClE,UAAM,MAAM,MAAM,qBAAqB;AAAA,MACrC,SAAS,KAAK;AAAA,MACd;AAAA,MACA,aAAa;AAAA,QACX,QAAQ,QAAQ;AAAA,QAChB,UAAU,eAAe,QAAQ;AAAA,QACjC,OAAO,QAAQ,QAAQ,qBAAqB,QAAQ,KAAK,IAAI,CAAC;AAAA,QAC9D,GAAG,QAAQ;AAAA,QACX,GAAG,QAAQ;AAAA,MACb;AAAA,IACF,CAAC;AAED,UAAM,SAAS,IACZ,YAAY,0BAA0B,QAAQ,OAAO,WAAW,CAAC,EACjE,YAAY,IAAI,4BAA4B,CAAC;AAEhD,WAAO,sBAAsB,MAAM;AAAA,EACrC;AACF;","names":[]}